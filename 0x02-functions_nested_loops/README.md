more and more functions and nested loops
